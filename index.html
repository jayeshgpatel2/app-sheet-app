<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>InArt Stock Dashboard - Secure</title>
  
  <!-- React & Babel -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary: #2563eb;
      --primary-dark: #1e40af;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --dark: #111827;
      --gray-50: #f9fafb;
      --gray-100: #f3f4f6;
      --gray-200: #e5e7eb;
      --gray-600: #4b5563;
      --gray-900: #111827;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      background: var(--gray-50);
      color: var(--gray-900);
      line-height: 1.5;
    }

    /* === LOGIN SCREEN === */
    .login-container {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      padding: 1rem;
    }

    .login-box {
      background: white;
      padding: 2rem;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      width: 100%;
      max-width: 400px;
    }

    .login-logo {
      text-align: center;
      font-size: 3rem;
      margin-bottom: 1rem;
    }

    .login-title {
      text-align: center;
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      color: var(--gray-900);
    }

    .login-subtitle {
      text-align: center;
      font-size: 0.875rem;
      color: var(--gray-600);
      margin-bottom: 2rem;
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-label {
      display: block;
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--gray-900);
      margin-bottom: 0.5rem;
    }

    .form-input {
      width: 100%;
      padding: 0.75rem 1rem;
      border: 2px solid var(--gray-200);
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.2s;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .login-btn {
      width: 100%;
      padding: 0.875rem;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }

    .login-btn:hover {
      background: var(--primary-dark);
    }

    .login-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .error-message {
      background: #fee2e2;
      color: #991b1b;
      padding: 0.75rem;
      border-radius: 8px;
      font-size: 0.875rem;
      margin-bottom: 1rem;
      text-align: center;
    }

    /* === HEADER === */
    .header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      padding: 1rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-content {
      max-width: 100%;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
    }

    .header-title {
      font-size: 1.5rem;
      font-weight: 700;
    }

    .logout-btn {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      font-size: 0.875rem;
      cursor: pointer;
      backdrop-filter: blur(10px);
      transition: background 0.2s;
    }

    .logout-btn:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    /* === MAIN CONTAINER === */
    .container {
      width: 100%;
      max-width: 100%;
      margin: 0 auto;
      padding: 1rem;
    }

    /* === STATS === */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .stat-card {
      background: white;
      padding: 1rem;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      border-left: 4px solid var(--primary);
    }

    .stat-label {
      font-size: 0.75rem;
      color: var(--gray-600);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.25rem;
    }

    .stat-value {
      font-size: 1.75rem;
      font-weight: 700;
    }

    .stat-sub {
      font-size: 0.75rem;
      color: var(--gray-600);
      margin-top: 0.25rem;
    }

    /* === FILTERS === */
    .filters {
      background: white;
      padding: 1rem;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      margin-bottom: 1.5rem;
    }

    .search-box {
      position: relative;
      margin-bottom: 1rem;
    }

    .search-input {
      width: 100%;
      padding: 0.75rem 1rem 0.75rem 2.5rem;
      border: 2px solid var(--gray-200);
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.2s;
    }

    .search-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .search-icon {
      position: absolute;
      left: 0.75rem;
      top: 50%;
      transform: translateY(-50%);
      color: var(--gray-600);
    }

    .filter-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 0.75rem;
    }

    .filter-select {
      padding: 0.75rem;
      border: 2px solid var(--gray-200);
      border-radius: 8px;
      font-size: 0.875rem;
      background: white;
      cursor: pointer;
      transition: all 0.2s;
    }

    .filter-select:focus {
      outline: none;
      border-color: var(--primary);
    }

    /* === QUICK FILTERS === */
    .quick-filters {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1.5rem;
      overflow-x: auto;
      padding-bottom: 0.5rem;
    }

    .quick-filter-btn {
      padding: 0.5rem 1rem;
      border: 2px solid var(--gray-200);
      border-radius: 999px;
      background: white;
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.2s;
    }

    .quick-filter-btn:hover {
      border-color: var(--primary);
      color: var(--primary);
    }

    .quick-filter-btn.active {
      background: var(--primary);
      color: white;
      border-color: var(--primary);
    }

    /* === TABLE CONTAINER === */
    .table-container {
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      overflow: hidden;
    }

    /* === TABLE DESIGN (Desktop) === */
    .product-table {
      width: 100%;
      border-collapse: collapse;
      display: none; /* Hidden on mobile */
    }

    .product-table thead {
      background: var(--gray-900);
      color: white;
    }

    .product-table th {
      padding: 1rem;
      text-align: left;
      font-weight: 600;
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .product-table td {
      padding: 1rem;
      border-bottom: 1px solid var(--gray-200);
      vertical-align: middle;
    }

    .product-table tbody tr:hover {
      background: var(--gray-50);
    }

    .product-table tbody tr:last-child td {
      border-bottom: none;
    }

    /* === IMAGE IN TABLE === */
    .table-image-cell {
      width: 100px;
    }

    .table-image {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 8px;
      cursor: pointer;
      border: 2px solid var(--gray-200);
      transition: transform 0.2s;
    }

    .table-image:hover {
      transform: scale(1.05);
      border-color: var(--primary);
    }

    .table-image-placeholder {
      width: 80px;
      height: 80px;
      background: var(--gray-100);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      color: var(--gray-600);
    }

    /* === PRODUCT INFO IN TABLE === */
    .product-name-cell {
      font-weight: 600;
      color: var(--gray-900);
      max-width: 200px;
    }

    .product-category-text {
      font-size: 0.875rem;
      color: var(--gray-600);
      margin-top: 0.25rem;
    }

    /* === STOCK BADGE === */
    .stock-badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: 999px;
      font-size: 0.875rem;
      font-weight: 600;
    }

    .stock-ok { background: #d1fae5; color: #065f46; }
    .stock-low { background: #fed7aa; color: #92400e; }
    .stock-zero { background: #fecaca; color: #991b1b; }

    /* === MOBILE CARD VIEW === */
    .mobile-products {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1rem;
    }

    .mobile-product-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      overflow: hidden;
    }

    .mobile-card-header {
      display: flex;
      gap: 1rem;
      padding: 1rem;
      border-bottom: 2px solid var(--gray-200);
      background: var(--gray-50);
    }

    .mobile-image-container {
      flex-shrink: 0;
      width: 100px;
      height: 100px;
      border-radius: 8px;
      overflow: hidden;
      background: white;
      border: 2px solid var(--gray-200);
      cursor: pointer;
    }

    .mobile-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .mobile-image-placeholder {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5rem;
      color: var(--gray-600);
      background: var(--gray-100);
    }

    .mobile-card-info {
      flex: 1;
      min-width: 0;
    }

    .mobile-product-name {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 0.25rem;
    }

    .mobile-product-category {
      font-size: 0.875rem;
      color: var(--gray-600);
      margin-bottom: 0.5rem;
    }

    .mobile-card-body {
      padding: 1rem;
    }

    .mobile-details-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.75rem;
    }

    .mobile-detail-item {
      display: flex;
      flex-direction: column;
    }

    .mobile-detail-label {
      font-size: 0.75rem;
      color: var(--gray-600);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.25rem;
    }

    .mobile-detail-value {
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--gray-900);
      word-break: break-all;
    }

    /* === IMAGE MODAL === */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 1rem;
    }

    .modal-content {
      max-width: 90vw;
      max-height: 90vh;
      position: relative;
    }

    .modal-image {
      max-width: 100%;
      max-height: 90vh;
      border-radius: 8px;
    }

    .modal-close {
      position: absolute;
      top: -2.5rem;
      right: 0;
      background: white;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* === LOADING === */
    .loading-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 3rem;
      gap: 1rem;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid var(--gray-200);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* === EMPTY STATE === */
    .empty-state {
      text-align: center;
      padding: 3rem 1rem;
    }

    .empty-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
      opacity: 0.5;
    }

    /* === RESPONSIVE === */
    @media (min-width: 768px) {
      .container {
        padding: 2rem;
      }

      .mobile-products {
        display: none; /* Hide mobile cards on desktop */
      }

      .product-table {
        display: table; /* Show table on desktop */
      }

      .table-image {
        width: 100px;
        height: 100px;
      }

      .table-image-placeholder {
        width: 100px;
        height: 100px;
      }
    }

    @media (max-width: 767px) {
      .product-table {
        display: none; /* Hide table on mobile */
      }

      .mobile-products {
        display: grid; /* Show cards on mobile */
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;

    // === CONFIGURATION ===
    const CONFIG = {
      // üîê CHANGE THESE CREDENTIALS!
      USERNAME: "admin",
      PASSWORD: "inart2024",
      
      PRODUCT_CSV: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTigsGhlpnrwXI_q8RklVhfc7cD8dezLyLS9fXHN842Tk6dM430UVo5UTMjFKV08P3f0pKNtsadi-t3/pub?gid=2104089495&single=true&output=csv",
      SALES_CSV: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTigsGhlpnrwXI_q8RklVhfc7cD8dezLyLS9fXHN842Tk6dM430UVo5UTMjFKV08P3f0pKNtsadi-t3/pub?gid=438476529&single=true&output=csv",
      PURCHASES_CSV: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTigsGhlpnrwXI_q8RklVhfc7cD8dezLyLS9fXHN842Tk6dM430UVo5UTMjFKV08P3f0pKNtsadi-t3/pub?gid=1808784762&single=true&output=csv"
    };

    // === UTILITY FUNCTIONS ===
    function parseCSV(text) {
      const lines = text.trim().split(/\r?\n/);
      return lines.map(line => {
        const result = [];
        let current = '';
        let inQuotes = false;
        for (let i = 0; i < line.length; i++) {
          const char = line[i];
          if (char === '"' && line[i + 1] === '"') {
            current += '"';
            i++;
          } else if (char === '"') {
            inQuotes = !inQuotes;
          } else if (char === ',' && !inQuotes) {
            result.push(current);
            current = '';
          } else {
            current += char;
          }
        }
        result.push(current);
        return result;
      });
    }

    function indexHeaders(row) {
      const map = {};
      row.forEach((h, idx) => {
        map[h.trim()] = idx;
      });
      return map;
    }

    async function fetchCSV(url) {
      const res = await fetch(url);
      if (!res.ok) throw new Error(`Failed to fetch ${url}`);
      const txt = await res.text();
      return parseCSV(txt);
    }

    // === LOGIN COMPONENT ===
    function LoginScreen({ onLogin }) {
      const [username, setUsername] = useState('');
      const [password, setPassword] = useState('');
      const [error, setError] = useState('');
      const [loading, setLoading] = useState(false);

      const handleSubmit = (e) => {
        e.preventDefault();
        setError('');
        setLoading(true);

        setTimeout(() => {
          if (username === CONFIG.USERNAME && password === CONFIG.PASSWORD) {
            onLogin();
          } else {
            setError('Invalid username or password');
            setLoading(false);
          }
        }, 500);
      };

      return (
        <div className="login-container">
          <div className="login-box">
            <div className="login-logo">üîê</div>
            <h1 className="login-title">InArt Stock Dashboard</h1>
            <p className="login-subtitle">Please login to continue</p>

            {error && <div className="error-message">{error}</div>}

            <form onSubmit={handleSubmit}>
              <div className="form-group">
                <label className="form-label">Username</label>
                <input
                  type="text"
                  className="form-input"
                  value={username}
                  onChange={(e) => setUsername(e.target.value)}
                  placeholder="Enter username"
                  required
                  autoFocus
                />
              </div>

              <div className="form-group">
                <label className="form-label">Password</label>
                <input
                  type="password"
                  className="form-input"
                  value={password}
                  onChange={(e) => setPassword(e.target.value)}
                  placeholder="Enter password"
                  required
                />
              </div>

              <button type="submit" className="login-btn" disabled={loading}>
                {loading ? 'Logging in...' : 'Login'}
              </button>
            </form>
          </div>
        </div>
      );
    }

    // === MAIN APP ===
    function App() {
      const [isAuthenticated, setIsAuthenticated] = useState(false);
      const [products, setProducts] = useState([]);
      const [loading, setLoading] = useState(true);
      const [error, setError] = useState(null);
      const [searchTerm, setSearchTerm] = useState('');
      const [categoryFilter, setCategoryFilter] = useState('');
      const [vendorFilter, setVendorFilter] = useState('');
      const [viewMode, setViewMode] = useState('all');
      const [sortBy, setSortBy] = useState('name');
      const [modalImage, setModalImage] = useState(null);

      // Check if already logged in (session storage)
      useEffect(() => {
        const auth = sessionStorage.getItem('isAuthenticated');
        if (auth === 'true') {
          setIsAuthenticated(true);
        }
      }, []);

      const handleLogin = () => {
        setIsAuthenticated(true);
        sessionStorage.setItem('isAuthenticated', 'true');
      };

      const handleLogout = () => {
        setIsAuthenticated(false);
        sessionStorage.removeItem('isAuthenticated');
      };

      // Load data
      useEffect(() => {
        if (isAuthenticated) {
          loadData();
        }
      }, [isAuthenticated]);

      async function loadData() {
        setLoading(true);
        setError(null);

        try {
          const [prodRows, salesRows, purchaseRows] = await Promise.all([
            fetchCSV(CONFIG.PRODUCT_CSV),
            fetchCSV(CONFIG.SALES_CSV),
            fetchCSV(CONFIG.PURCHASES_CSV)
          ]);

          const prodHeader = indexHeaders(prodRows[0]);
          const salesHeader = indexHeaders(salesRows[0] || []);
          const purchHeader = indexHeaders(purchaseRows[0] || []);

          const productsByBarcode = {};

          for (let i = 1; i < prodRows.length; i++) {
            const r = prodRows[i];
            if (!r.length || r.every(cell => !cell)) continue;

            const barcode = r[prodHeader["Product Barcode"]] || "";
            if (!barcode) continue;

            productsByBarcode[barcode] = {
              barcode,
              name: r[prodHeader["Product"]] || "",
              category: r[prodHeader["Category"]] || "",
              vendor: r[prodHeader["Vendor"]] || "",
              asin: r[prodHeader["AMAZON ASIN INART"]] || "",
              sku: r[prodHeader["AMAZON SKU INART"]] || "",
              image: r[prodHeader["Image_URL"]] || r[prodHeader["Image"]] || r[prodHeader["AMAZON IMAGE"]] || "",
              cost: r[prodHeader["Cost"]] || "",
              initialStock: Number(r[prodHeader["Initial Stock"]] || 0),
              restockLevel: Number(r[prodHeader["Restock Level"]] || 0),
              purchases: 0,
              sales: 0
            };
          }

          if (salesRows.length > 1) {
            const idxBarcode = salesHeader["Product Barcode"];
            const idxQty = salesHeader["Quantity"];
            for (let i = 1; i < salesRows.length; i++) {
              const r = salesRows[i];
              if (!r.length || r.every(cell => !cell)) continue;
              const bc = r[idxBarcode] || "";
              const qty = Number(r[idxQty] || 0);
              if (productsByBarcode[bc]) {
                productsByBarcode[bc].sales += qty;
              }
            }
          }

          if (purchaseRows.length > 1) {
            const idxBarcode = purchHeader["Product Barcode"];
            const idxQty = purchHeader["Quantity"];
            for (let i = 1; i < purchaseRows.length; i++) {
              const r = purchaseRows[i];
              if (!r.length || r.every(cell => !cell)) continue;
              const bc = r[idxBarcode] || "";
              const qty = Number(r[idxQty] || 0);
              if (productsByBarcode[bc]) {
                productsByBarcode[bc].purchases += qty;
              }
            }
          }

          const productsList = Object.values(productsByBarcode).map(p => ({
            ...p,
            currentStock: p.initialStock + p.purchases - p.sales
          }));

          setProducts(productsList);
        } catch (err) {
          console.error(err);
          setError(err.message);
        } finally {
          setLoading(false);
        }
      }

      if (!isAuthenticated) {
        return <LoginScreen onLogin={handleLogin} />;
      }

      const categories = useMemo(() => {
        const cats = new Set(products.map(p => p.category).filter(Boolean));
        return Array.from(cats).sort();
      }, [products]);

      const vendors = useMemo(() => {
        const vends = new Set(products.map(p => p.vendor).filter(Boolean));
        return Array.from(vends).sort();
      }, [products]);

      const filteredProducts = useMemo(() => {
        let filtered = products;

        if (viewMode === 'low') {
          filtered = filtered.filter(p => p.currentStock <= p.restockLevel && p.currentStock > 0);
        } else if (viewMode === 'zero') {
          filtered = filtered.filter(p => p.currentStock <= 0);
        } else if (viewMode === 'best') {
          filtered = filtered.filter(p => p.sales > 0);
        }

        if (categoryFilter) {
          filtered = filtered.filter(p => p.category === categoryFilter);
        }

        if (vendorFilter) {
          filtered = filtered.filter(p => p.vendor === vendorFilter);
        }

        if (searchTerm) {
          const term = searchTerm.toLowerCase();
          filtered = filtered.filter(p => {
            const searchText = [
              p.name,
              p.barcode,
              p.category,
              p.vendor,
              p.asin,
              p.sku
            ].join(' ').toLowerCase();
            return searchText.includes(term);
          });
        }

        const sorted = [...filtered];
        if (sortBy === 'name') {
          sorted.sort((a, b) => (a.name || a.barcode).localeCompare(b.name || b.barcode));
        } else if (sortBy === 'stockDesc') {
          sorted.sort((a, b) => b.currentStock - a.currentStock);
        } else if (sortBy === 'stockAsc') {
          sorted.sort((a, b) => a.currentStock - b.currentStock);
        } else if (sortBy === 'salesDesc') {
          sorted.sort((a, b) => b.sales - a.sales);
        }

        return sorted;
      }, [products, viewMode, categoryFilter, vendorFilter, searchTerm, sortBy]);

      const stats = useMemo(() => {
        const totalUnits = products.reduce((sum, p) => sum + p.currentStock, 0);
        const lowStock = products.filter(p => p.currentStock > 0 && p.currentStock <= p.restockLevel).length;
        const outOfStock = products.filter(p => p.currentStock <= 0).length;
        const bestSeller = products.reduce((best, p) => p.sales > (best?.sales || 0) ? p : best, null);

        return {
          totalProducts: products.length,
          totalCategories: categories.length,
          totalUnits,
          lowStock,
          outOfStock,
          bestSeller
        };
      }, [products, categories]);

      if (loading) {
        return (
          <div className="loading-container">
            <div className="spinner"></div>
            <div style={{color: 'var(--gray-600)', fontSize: '0.875rem'}}>Loading products...</div>
          </div>
        );
      }

      return (
        <>
          <header className="header">
            <div className="header-content">
              <h1 className="header-title">üì¶ InArt Stock</h1>
              <button className="logout-btn" onClick={handleLogout}>
                Logout
              </button>
            </div>
          </header>

          <div className="container">
            {/* Stats */}
            <div className="stats-grid">
              <div className="stat-card">
                <div className="stat-label">Total SKUs</div>
                <div className="stat-value">{stats.totalProducts}</div>
                <div className="stat-sub">{stats.totalCategories} categories</div>
              </div>
              <div className="stat-card">
                <div className="stat-label">Units in Stock</div>
                <div className="stat-value">{stats.totalUnits.toLocaleString()}</div>
                <div className="stat-sub">{stats.lowStock} low stock</div>
              </div>
              <div className="stat-card">
                <div className="stat-label">Out of Stock</div>
                <div className="stat-value">{stats.outOfStock}</div>
                <div className="stat-sub">Need restock</div>
              </div>
              <div className="stat-card">
                <div className="stat-label">Best Seller</div>
                <div className="stat-value" style={{fontSize: '1rem'}}>
                  {stats.bestSeller ? (stats.bestSeller.name || stats.bestSeller.barcode).substring(0, 20) : '‚Äî'}
                </div>
                <div className="stat-sub">
                  {stats.bestSeller ? `${stats.bestSeller.sales} sold` : 'No sales'}
                </div>
              </div>
            </div>

            {/* Filters */}
            <div className="filters">
              <div className="search-box">
                <span className="search-icon">üîç</span>
                <input
                  type="text"
                  className="search-input"
                  placeholder="Search by name, barcode, ASIN, SKU..."
                  value={searchTerm}
                  onChange={(e) => setSearchTerm(e.target.value)}
                />
              </div>
              <div className="filter-row">
                <select className="filter-select" value={categoryFilter} onChange={(e) => setCategoryFilter(e.target.value)}>
                  <option value="">All Categories</option>
                  {categories.map(cat => (
                    <option key={cat} value={cat}>{cat}</option>
                  ))}
                </select>
                <select className="filter-select" value={vendorFilter} onChange={(e) => setVendorFilter(e.target.value)}>
                  <option value="">All Vendors</option>
                  {vendors.map(vendor => (
                    <option key={vendor} value={vendor}>{vendor}</option>
                  ))}
                </select>
                <select className="filter-select" value={sortBy} onChange={(e) => setSortBy(e.target.value)}>
                  <option value="name">Sort: A-Z</option>
                  <option value="stockDesc">Stock: High ‚Üí Low</option>
                  <option value="stockAsc">Stock: Low ‚Üí High</option>
                  <option value="salesDesc">Best Sellers</option>
                </select>
              </div>
            </div>

            {/* Quick Filters */}
            <div className="quick-filters">
              <button className={`quick-filter-btn ${viewMode === 'all' ? 'active' : ''}`} onClick={() => setViewMode('all')}>
                All Products
              </button>
              <button className={`quick-filter-btn ${viewMode === 'low' ? 'active' : ''}`} onClick={() => setViewMode('low')}>
                Low Stock
              </button>
              <button className={`quick-filter-btn ${viewMode === 'zero' ? 'active' : ''}`} onClick={() => setViewMode('zero')}>
                Out of Stock
              </button>
              <button className={`quick-filter-btn ${viewMode === 'best' ? 'active' : ''}`} onClick={() => setViewMode('best')}>
                Best Sellers
              </button>
            </div>

            {/* Products Table/Cards */}
            <div className="table-container">
              {/* DESKTOP TABLE VIEW */}
              <table className="product-table">
                <thead>
                  <tr>
                    <th>Image</th>
                    <th>Product</th>
                    <th>Category</th>
                    <th>Vendor</th>
                    <th>ASIN</th>
                    <th>SKU</th>
                    <th>Stock</th>
                    <th>Cost</th>
                    <th>Sales</th>
                  </tr>
                </thead>
                <tbody>
                  {filteredProducts.map(product => (
                    <ProductTableRow
                      key={product.barcode}
                      product={product}
                      onImageClick={setModalImage}
                    />
                  ))}
                </tbody>
              </table>

              {/* MOBILE CARD VIEW */}
              <div className="mobile-products">
                {filteredProducts.map(product => (
                  <MobileProductCard
                    key={product.barcode}
                    product={product}
                    onImageClick={setModalImage}
                  />
                ))}
              </div>
            </div>

            {filteredProducts.length === 0 && (
              <div className="empty-state">
                <div className="empty-icon">üì¶</div>
                <h3>No Products Found</h3>
                <p style={{color: 'var(--gray-600)', fontSize: '0.875rem'}}>Try adjusting your filters</p>
              </div>
            )}
          </div>

          {/* Image Modal */}
          {modalImage && (
            <div className="modal-overlay" onClick={() => setModalImage(null)}>
              <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                <button className="modal-close" onClick={() => setModalImage(null)}>√ó</button>
                <img src={modalImage} alt="Product" className="modal-image" />
              </div>
            </div>
          )}
        </>
      );
    }

    // === DESKTOP TABLE ROW ===
    function ProductTableRow({ product, onImageClick }) {
      const [imageError, setImageError] = useState(false);
      
      const stockClass = product.currentStock <= 0 
        ? 'stock-zero' 
        : product.currentStock <= product.restockLevel 
          ? 'stock-low' 
          : 'stock-ok';

      return (
        <tr>
          <td className="table-image-cell">
            {product.image && !imageError ? (
              <img
                src={product.image}
                alt={product.name}
                className="table-image"
                onError={() => setImageError(true)}
                onClick={() => onImageClick(product.image)}
                loading="lazy"
              />
            ) : (
              <div className="table-image-placeholder">üì¶</div>
            )}
          </td>
          <td>
            <div className="product-name-cell">{product.name || product.barcode}</div>
          </td>
          <td>{product.category || '‚Äî'}</td>
          <td>{product.vendor || '‚Äî'}</td>
          <td>{product.asin || '‚Äî'}</td>
          <td>{product.sku || '‚Äî'}</td>
          <td>
            <span className={`stock-badge ${stockClass}`}>
              {product.currentStock}
            </span>
          </td>
          <td>{product.cost || '‚Äî'}</td>
          <td>{product.sales}</td>
        </tr>
      );
    }

    // === MOBILE CARD ===
    function MobileProductCard({ product, onImageClick }) {
      const [imageError, setImageError] = useState(false);
      
      const stockClass = product.currentStock <= 0 
        ? 'stock-zero' 
        : product.currentStock <= product.restockLevel 
          ? 'stock-low' 
          : 'stock-ok';

      return (
        <div className="mobile-product-card">
          <div className="mobile-card-header">
            <div 
              className="mobile-image-container"
              onClick={() => product.image && !imageError && onImageClick(product.image)}
            >
              {product.image && !imageError ? (
                <img
                  src={product.image}
                  alt={product.name}
                  className="mobile-image"
                  onError={() => setImageError(true)}
                  loading="lazy"
                />
              ) : (
                <div className="mobile-image-placeholder">üì¶</div>
              )}
            </div>
            <div className="mobile-card-info">
              <div className="mobile-product-name">{product.name || product.barcode}</div>
              <div className="mobile-product-category">{product.category}</div>
              <span className={`stock-badge ${stockClass}`}>
                {product.currentStock} in stock
              </span>
            </div>
          </div>
          <div className="mobile-card-body">
            <div className="mobile-details-grid">
              <div className="mobile-detail-item">
                <div className="mobile-detail-label">Vendor</div>
                <div className="mobile-detail-value">{product.vendor || '‚Äî'}</div>
              </div>
              <div className="mobile-detail-item">
                <div className="mobile-detail-label">Cost</div>
                <div className="mobile-detail-value">{product.cost || '‚Äî'}</div>
              </div>
              <div className="mobile-detail-item">
                <div className="mobile-detail-label">ASIN</div>
                <div className="mobile-detail-value">{product.asin || '‚Äî'}</div>
              </div>
              <div className="mobile-detail-item">
                <div className="mobile-detail-label">SKU</div>
                <div className="mobile-detail-value">{product.sku || '‚Äî'}</div>
              </div>
              <div className="mobile-detail-item">
                <div className="mobile-detail-label">Barcode</div>
                <div className="mobile-detail-value">{product.barcode}</div>
              </div>
              <div className="mobile-detail-item">
                <div className="mobile-detail-label">Sales</div>
                <div className="mobile-detail-value">{product.sales}</div>
              </div>
            </div>
          </div>
        </div>
      );
    }

    // === RENDER ===
    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
